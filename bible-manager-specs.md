# Техническое задание: Bible-Manager

## 1. Общая информация

**Название продукта:** Bible-Manager  
**Цель:** Создание интерактивного инструмента для управления "библией мира" при работе над литературными проектами с использованием ИИ

## 2. Основной функционал

### 2.1. Организация элементов мира

- **Категоризация контента:** Хранение и структурирование информации о персонажах, технологиях, локациях, социальных структурах, хронологиях
- **Связи между элементами:** Визуальное и программное представление взаимосвязей между элементами мира
- **Иерархия канона:** Разделение информации на первичный канон (неизменный), вторичный канон (развивающийся) и предположения (неподтвержденные)

### 2.2. Управление состоянием мира

- **Версионирование:** Создание и хранение "снимков" состояния мира на определенных этапах истории
- **История изменений:** Отслеживание внесенных изменений с возможностью отката
- **Фильтрация по главам:** Отображение элементов, введенных или измененных в конкретных главах

### 2.3. Выявление и разрешение противоречий

- **Автоматический анализ:** Выявление потенциальных логических несоответствий между элементами
- **Интерфейс разрешения конфликтов:** Инструменты для принятия решений по устранению противоречий
- **Система предупреждений:** Уведомления о возможных противоречиях при добавлении новых элементов

### 2.4. Генерация ситуационных брифов

- **Селектор элементов:** Интерактивный выбор релевантных компонентов для конкретной сцены
- **Шаблоны брифов:** Настраиваемые шаблоны для различных типов сцен
- **Экспорт в формат для ИИ:** Оптимизация вывода для контекстного окна ИИ

## 3. Дополнительный функционал

### 3.1. Расширенная работа с каноном

- **Метрики стабильности:** Анализ целостности мира и выявление слабых мест
- **Рейтинг каноничности:** Автоматическая оценка соответствия новых элементов существующему канону
- **Граф развития канона:** Визуализация эволюции мира и ключевых изменений
- **Временное исключение:** Возможность временно "отключать" определенные элементы мира для экспериментов

### 3.2. Инструменты генерации контента

- **Генератор запросов к ИИ:** Конструктор промптов с автоматическим включением релевантных деталей
- **Проверка ответов ИИ:** Анализ сгенерированного контента на соответствие канону
- **Выделение новых элементов:** Автоматическое выявление новых деталей мира в тексте ИИ

### 3.3. Коллаборация и экспорт

- **Экспорт в различные форматы:** Markdown, PDF, JSON, HTML, Word
- **Система комментариев:** Возможность оставлять заметки к элементам без изменения их содержания
- **Совместная работа:** Опциональный режим для нескольких авторов (через файлы обмена)
- **Публичный справочник:** Генерация веб-страницы с информацией о мире для читателей

## 4. Техническая реализация

### 4.1. Архитектура приложения

- **Frontend:** React с TypeScript
- **Состояние:** Redux или Context API с персистентностью (сохранение в localStorage/IndexedDB)
- **UI библиотека:** Material-UI или Ant Design
- **Визуализация связей:** D3.js или react-force-graph
- **Поддержка плагинов:** Архитектура, допускающая расширение функциональности

### 4.2. Структура данных

```typescript
interface WorldElement {
  id: string;
  type: "character" | "technology" | "location" | "event" | "concept";
  name: string;
  description: string;
  properties: Record<string, any>; // Специфичные для типа свойства
  canonTier: "primary" | "secondary" | "speculative";
  appearances: string[]; // Главы/сцены, где элемент упоминается
  relationships: Array<{
    targetId: string;
    type: string;
    description: string;
  }>;
  createdAt: Date;
  modifiedAt: Date;
  version: number;
  tags: string[];
  notes: string;
  conflicts: Array<{
    withElementId: string;
    description: string;
    status: "unresolved" | "resolved" | "ignored";
    resolution?: string;
  }>;
}

interface World {
  id: string;
  name: string;
  description: string;
  elements: Record<string, WorldElement>;
  chapters: Array<{
    id: string;
    title: string;
    newElements: string[]; // ID элементов, введенных в этой главе
    modifiedElements: string[]; // ID элементов, измененных в этой главе
  }>;
  snapshots: Array<{
    id: string;
    date: Date;
    description: string;
    worldState: string; // Сериализованное состояние мира
  }>;
  rules: Array<{
    id: string;
    description: string;
    condition: string; // Условие, проверяемое программно
    severity: "warning" | "error";
  }>;
}
```

### 4.3. Локальное хранение

- **Сохранение на диск:** Автоматическое и ручное сохранение в JSON-файлы
- **Импорт/экспорт:** Возможность переноса между устройствами
- **Резервное копирование:** Автоматическое создание резервных копий с настраиваемой периодичностью

## 5. Пользовательский интерфейс

### 5.1. Основные экраны

- **Дашборд:** Общий обзор мира с ключевыми статистиками и доступом к последним изменениям
- **Редактор элементов:** Интерфейс создания и редактирования элементов мира
- **Карта связей:** Визуализация взаимосвязей между элементами
- **Хронология:** Временная линия событий и изменений в мире
- **Конфликты:** Список обнаруженных противоречий и инструменты их разрешения
- **Генератор брифов:** Интерфейс создания контекстов для генерации текста

### 5.2. Конструктор ситуационных брифов

- **Этап выбора ключевых элементов:** Многошаговый процесс отбора персонажей, локаций, технологий
- **Автоматические рекомендации:** Предложение связанных элементов на основе выбранных
- **Приоритизация информации:** Ранжирование деталей по важности для контекста
- **Предпросмотр:** Визуализация итогового брифа с возможностью редактирования
- **Шаблоны:** Сохранение настраиваемых шаблонов для типичных сцен

### 5.3. Система разрешения конфликтов

- **Панель конфликтов:** Визуальное представление противоречащих элементов
- **Детальный анализ:** Объяснение природы противоречия и возможных путей решения
- **Истории изменений:** Отслеживание эволюции конфликтующих элементов
- **Трекинг решений:** Запись принятых решений по устранению противоречий для справки

## 6. Экспорт и интеграции

### 6.1. Форматы экспорта

- **Markdown:** Для документации и обмена
- **JSON:** Для переноса данных и резервных копий
- **PDF:** Для печати и архивирования
- **HTML:** Для публикации и веб-доступа
- **TXT:** Для прямой интеграции с ИИ-ассистентами

### 6.2. Специализированные экспорты

- **Ситуационный бриф:** Компактный экспорт релевантного контекста для сцены
- **Досье персонажа:** Полная информация о конкретном персонаже
- **Технологический справочник:** Список технологий с объяснениями
- **Хронологическая шкала:** Временная линия всех событий
- **Социальная карта:** Схема взаимоотношений персонажей

### 6.3. Интеграции (опционально)

- **API для внешних инструментов:** Возможность подключения других приложений
- **Прямая связь с ИИ-системами:** Опциональная интеграция с API для ИИ-генерации
- **Экспорт в системы управления проектами:** Интеграция с Notion, Obsidian, Scrivener

## 7. Требования к пользовательскому опыту

- **Интуитивность:** Простой и понятный интерфейс, не требующий специальных технических знаний
- **Отзывчивость:** Быстрая работа даже с большими мирами
- **Адаптивность:** Поддержка различных размеров экрана
- **Настраиваемость:** Возможность адаптации под индивидуальный рабочий процесс
- **Низкий порог входа:** Возможность начать работу без длительной настройки
